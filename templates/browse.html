<?php include 'includes/header.php'; ?>
<link rel="stylesheet" href="assets/css/browse.css" />

<div class="browse-page">
  <div class="page-header">
    <h1 class="page-title">ğŸ” Browse Recipes</h1>
    <p class="page-subtitle">Find the perfect recipe for any occasion</p>
  </div>

  <!-- Category Filter -->
  <div class="filter-section">
    <div class="filter-container">
      <a
        href="browse.php"
        class="filter-btn <?php echo empty($category_filter) ? 'active' : ''; ?>"
      >
        ğŸ´ All Recipes
      </a>
      <?php foreach ($categories as $cat): ?>
      <a
        href="browse.php?category=<?php echo urlencode($cat); ?>"
        class="filter-btn <?php echo $category_filter === $cat ? 'active' : ''; ?>"
      >
        <?php echo getCategoryEmoji($cat) . ' ' . $cat; ?>
      </a>
      <?php endforeach; ?>
    </div>
  </div>

  <!-- Results -->
  <div class="recipes-container">
    <?php if (!empty($category_filter)): ?>
    <div class="results-header">
      <h2 class="results-title">
        <?php echo getCategoryEmoji($category_filter) . ' ' . htmlspecialchars($category_filter); ?>
        Recipes
      </h2>
      <p class="results-count">
        <?php echo count($recipes); ?>
        recipe<?php echo count($recipes) != 1 ? 's' : ''; ?>
        found
      </p>
    </div>
    <?php endif; ?>

    <?php if (count($recipes) >
    0): ?>
    <div class="recipes-grid">
      <?php foreach ($recipes as $recipe): ?>
      <div
        class="recipe-card"
        onclick="window.location.href='recipe-detail.php?id=<?php echo $recipe['id']; ?>'"
      >
        <div class="recipe-image-container">
          <?php if (isset($recipe['image']) && $recipe['image']): ?>
          <img
            src="<?php echo htmlspecialchars($recipe['image']); ?>"
            alt="<?php echo htmlspecialchars($recipe['title']); ?>"
            class="recipe-image"
          />
          <?php else: ?>
          <div class="no-image">
            <?php echo getCategoryEmoji($recipe['category']); ?>
          </div>
          <?php endif; ?>
        </div>

        <div class="recipe-content">
          <span class="recipe-category">
            <?php echo getCategoryEmoji($recipe['category']) . ' ' . htmlspecialchars($recipe['category']); ?>
          </span>

          <h3 class="recipe-title">
            <?php echo htmlspecialchars($recipe['title']); ?>
          </h3>

          <div class="recipe-meta">
            <span class="recipe-author"
              >ğŸ‘¤
              <?php echo htmlspecialchars($recipe['author_name']); ?></span
            >
            <?php 
                                $prep = isset($recipe['prep_time']) ? $recipe['prep_time'] : 0;
                                $cook = isset($recipe['cook_time']) ? $recipe['cook_time'] : 0;
                                if ($prep >
            0 || $cook > 0): ?>
            <span
              >â±ï¸
              <?php echo ($prep + $cook); ?>
              mins</span
            >
            <?php endif; ?>
          </div>

          <?php if (isset($recipe['description']) && !empty($recipe['description'])): ?>
          <p class="recipe-description">
            <?php echo htmlspecialchars($recipe['description']); ?>
          </p>
          <?php endif; ?>

          <a
            href="recipe-detail.php?id=<?php echo $recipe['id']; ?>"
            class="btn-view"
            >View Recipe</a
          >
        </div>
      </div>
      <?php endforeach; ?>
    </div>
    <?php else: ?>
    <div class="no-recipes">
      <div class="no-recipes-icon">ğŸ˜•</div>
      <p class="no-recipes-text">No recipes found in this category</p>
      <a href="browse.php" class="btn-back">View All Recipes</a>
    </div>
    <?php endif; ?>
  </div>
</div>

<?php include 'includes/footer.php'; ?>
